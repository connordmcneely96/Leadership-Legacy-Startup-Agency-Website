# Cloudflare Workers Configuration for Leadership Legacy

name = "leadership-legacy"
main = "workers/api/index.ts"
compatibility_date = "2025-01-01"
account_id = "d3dbdd3e1ebbc28edf0ce756d9841490"

# Node.js compatibility for Next.js and Workers
node_compat = true

[build]
command = "npm run build"
pages_build_output_dir = "out"

# D1 Database - Contact submissions and analytics
[[d1_databases]]
binding = "DB"
database_name = "leadership-legacy-db"
database_id = "D1_DATABASE_ID_PLACEHOLDER" # Set via deployment secrets

# R2 Bucket - Media assets
[[r2_buckets]]
binding = "ASSETS"
bucket_name = "leadership-legacy-assets"

# KV Namespace - Configuration and feature flags
[[kv_namespaces]]
binding = "CONFIG"
id = "KV_NAMESPACE_ID_PLACEHOLDER" # Set via deployment secrets

# Environment variables
[vars]
ENVIRONMENT = "development"
NEXT_PUBLIC_API_URL = "https://leadership-legacy.YOUR_SUBDOMAIN.workers.dev"

# Production environment
[env.production]
name = "leadership-legacy-production"
vars = { ENVIRONMENT = "production" }

# Rate limiting for API endpoints
[[unsafe.bindings]]
name = "RATE_LIMITER"
type = "ratelimit"
namespace_id = "leadership_legacy_limiter"
simple = { limit = 100, period = 60 }
